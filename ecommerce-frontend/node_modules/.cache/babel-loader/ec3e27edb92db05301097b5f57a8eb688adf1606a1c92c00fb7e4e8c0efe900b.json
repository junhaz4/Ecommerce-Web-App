{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"display\": \"flex\",\n    \"align-items\": \"center\",\n    \"justify-content\": \"center\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"div_class\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h3\", null, \"You will be redirected to payment page\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"alert alert-primary\",\n  role: \"alert\"\n}, \" While making payment use card number 4242 4242 4242 4242 and enter random cvv(3 digit) \", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _hoisted_4, _createElementVNode(\"button\", {\n    class: \"btn checkout_button\",\n    id: \"proceed-to-checkout\",\n    onClick: _cache[0] || (_cache[0] = $event => $options.goToCheckout())\n  }, \" Make payment \")])]);\n}","map":{"version":3,"names":["style","class","_createElementVNode","role","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","id","onClick","_cache","$event","$options","goToCheckout"],"sources":["/Users/lawrencezhang/Desktop/ecommerce-ui/src/views/Checkout/Checkout.vue"],"sourcesContent":["<template>\n  <div style=\"display: flex; align-items: center; justify-content: center\">\n    <div class=\"div_class\">\n      <h3>You will be redirected to payment page</h3>\n\n      <div class=\"alert alert-primary\" role=\"alert\">\n        While making payment use card number 4242 4242 4242 4242 and enter\n        random cvv(3 digit)\n      </div>\n\n      <button\n        class=\"btn checkout_button\"\n        id=\"proceed-to-checkout\"\n        @click=\"goToCheckout()\"\n      >\n        Make payment\n      </button>\n    </div>\n  </div>\n</template>\n<script>\nconst axios = require(\"axios\");\nexport default {\n  data() {\n    return {\n      stripeAPIToken:\n        \"pk_test_51LQjzgJbdhuCmbNzvcolXqsKnvDOE9ytHwiWlu6zEhD1JwE5pJnkVQwA7rJdA6UtYUczvRiaVuM9b0ej9Zc0H1pO008AG7pmBr\",\n      // we will Initialize the Stripe library in this variable\n      stripe: \"\",\n      token: null,\n      sessionId: null,\n      checkoutBodyArray: [],\n    };\n  },\n\n  name: \"Checkout\",\n  props: [\"baseURL\"],\n  methods: {\n    /*\n            Includes Stripe.js dynamically\n        */\n    includeStripe(URL, callback) {\n      let documentTag = document,\n        tag = \"script\",\n        object = documentTag.createElement(tag),\n        scriptTag = documentTag.getElementsByTagName(tag)[0];\n      object.src = \"//\" + URL;\n      if (callback) {\n        object.addEventListener(\n          \"load\",\n          function (e) {\n            callback(null, e);\n          },\n          false\n        );\n      }\n      scriptTag.parentNode.insertBefore(object, scriptTag);\n    },\n\n    /*\n            Configures Stripe by setting up the elements and\n            creating the card element.\n        */\n    configureStripe() {\n      /* global Stripe */\n      this.stripe = Stripe(this.stripeAPIToken);\n    },\n\n    // get all cart Items for the user\n    getAllCartItems() {\n      axios.get(`${this.baseURL}cart/?token=${this.token}`).then(\n        (response) => {\n          if (response.status == 200) {\n            let cartItems = response.data.cartItems;\n            // for each cart item populate the checkoutBodyArray Array\n            cartItems.forEach((item) => {\n              this.checkoutBodyArray.push({\n                productName: item.product.name,\n                quantity: item.quantity,\n                price: item.product.price,\n                productId: item.product.id,\n              });\n            });\n          }\n        },\n        (err) => {\n          console.log(err);\n        }\n      );\n    },\n\n    // checkout\n    goToCheckout() {\n      // first call the create-checkout-session with checkoutBodyArray\n      axios\n        .post(\n          `${this.baseURL}order/create-checkout-session`,\n          this.checkoutBodyArray\n        )\n        .then((response) => {\n          // receive the sessionId in response\n          localStorage.setItem(\"sessionId\", response.data.sessionId);\n          return response.data;\n        })\n        .then((session) => {\n          // redirect to checkout page of stripe\n          return this.stripe.redirectToCheckout({\n            sessionId: session.sessionId,\n          });\n        });\n    },\n  },\n  mounted() {\n    // get the token\n    this.token = localStorage.getItem(\"token\");\n\n    // configure include stripe\n    this.includeStripe(\n      \"js.stripe.com/v3/\",\n      function () {\n        this.configureStripe();\n      }.bind(this)\n    );\n\n    // get all the cart items\n    this.getAllCartItems();\n  },\n};\n</script>\n\n<style>\n.div_class {\n  margin-top: 5%;\n  width: 50%;\n  align-content: center;\n}\n\n.checkout_button {\n  background-color: #5d3dec;\n  border: none;\n  color: white;\n  padding: 15px 30px;\n  text-align: center;\n  text-decoration: none;\n  font-size: 15px;\n  font-weight: bold;\n  border-radius: 15px;\n}\n\n.checkout_button:focus {\n  outline: none;\n  box-shadow: none;\n}\n\n.checkout_button:disabled {\n  background-color: #9b86f7;\n  border: none;\n  color: white;\n  padding: 15px 30px;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 15px;\n  font-weight: bold;\n  border-radius: 15px;\n  cursor: not-allowed;\n}\n</style>\n"],"mappings":";;EACOA,KAAmE,EAAnE;IAAA;IAAA;IAAA;EAAA;AAAmE;;EACjEC,KAAK,EAAC;AAAW;gCACpBC,mBAAA,CAA+C,YAA3C,wCAAsC;gCAE1CA,mBAAA,CAGM;EAHDD,KAAK,EAAC,qBAAqB;EAACE,IAAI,EAAC;GAAQ,0FAG9C;;;uBAPJC,mBAAA,CAiBM,OAjBNC,UAiBM,GAhBJH,mBAAA,CAeM,OAfNI,UAeM,GAdJC,UAA+C,EAE/CC,UAGM,EAENN,mBAAA,CAMS;IALPD,KAAK,EAAC,qBAAqB;IAC3BQ,EAAE,EAAC,qBAAqB;IACvBC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,QAAA,CAAAC,YAAY;KACrB,gBAED,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}